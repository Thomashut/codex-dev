<dom-module id="codex-view">
  <template>
  <firebase-auth
    user="{{user}}">
  </firebase-auth>

  <h1> View Post </h1>

  <template is="dom-if" if="[[!post]]">
      <p> ERROR - No Post Found <paper-button on-tap="home"> Return to Home </paper-button> </p>
  </template>

  <template is="dom-if" if="[[post]]">
    <ul>
      <li> [[post.title]] </li>
      <li> [[post.language]] </li>
      <li> [[post.author]] </li>
      <li> [[post.content]] </li>

      <br/>

      <li> [[post.conRank]] </li>
      <li> [[post.explainRank]] </li>
      <li> [[post.linkRank]] </li>
      <li> [[post.rank]] </li>
      <li> <paper-button id="saveButton" raised on-tap="savePost" post="[[post]]"
              alreadySaved="false"> Save Post </paper-button>
          </li>
    </ul>
  </template>

  </template>
  <script>
    class codex_view extends Polymer.Element {

      static get is() {return "codex-view";}

      static get properties() {
        return {
          user: {
            type: Object
          },
          post: {
            type: Object
          },
          page: {
            type: Object,
            notify: true
          }
        }
      }

      home() {
        this.$.page = "home";
      }

      savePost(e) {
        var postToSave = e.currentTarget.post;

        if(!postToSave) {
          console.log("Create Propper Error Messages - No Post to Save");
          return -1;
        }

        // Intilizse the saved List
        if(!localStorage.getItem("savedPosts")) {
          var savedPosts = new Array();
          savedPosts.push(postToSave);
          localStorage.setItem("savedPosts",JSON.stringify(savedPosts));
        } else {
          var savedPosts = JSON.parse(localStorage.getItem("savedPosts"))
          localStorage.removeItem("savedPosts"); // Clear local Storage
          savedPosts.push(postToSave);
          localStorage.setItem("savedPosts",JSON.stringify(savedPosts));
        }
      }
    }

    customElements.define(codex_view.is,codex_view);
  </script>
</dom-module>
